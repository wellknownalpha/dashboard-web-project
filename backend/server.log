🚀 Starting SecureOps Backend Server...
📋 Configuration Check:
   Tenant ID: ✅ Set
   Client ID: ✅ Set
   Client Secret: ✅ Set
🌐 Backend server running at http://localhost:3001
📋 Health check: http://localhost:3001/api/health

⚠️  If you see authentication errors:
   1. Check your Azure app registration client secret
   2. Ensure API permissions are granted
   3. Run: node test-api.js to verify credentials
📊 Fetching ALL users with licenses from Microsoft Graph...
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
✅ Graph API token acquired successfully
📄 Fetched 395 users (Total: 395)
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
✅ Successfully fetched 395 total users, 81 with target licenses
📊 Fetching ALL users with licenses from Microsoft Graph...
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
✅ Graph API token acquired successfully
📄 Fetched 395 users (Total: 395)
✅ Successfully fetched 395 total users, 81 with target licenses
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
📊 Fetching ALL users with licenses from Microsoft Graph...
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Graph API token acquired successfully
✅ Defender API token acquired successfully
📄 Fetched 395 users (Total: 395)
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
✅ Successfully fetched 395 total users, 81 with target licenses
📊 Fetching ALL users with licenses from Microsoft Graph...
✅ Graph API token acquired successfully
📄 Fetched 395 users (Total: 395)
✅ Successfully fetched 395 total users, 81 with target licenses
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
📊 Fetching ALL users with licenses from Microsoft Graph...
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Graph API token acquired successfully
✅ Defender API token acquired successfully
📄 Fetched 395 users (Total: 395)
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Successfully fetched 395 total users, 81 with target licenses
📊 Fetching ALL users with licenses from Microsoft Graph...
✅ Graph API token acquired successfully
✅ Defender API token acquired successfully
📄 Fetched 395 users (Total: 395)
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
✅ Successfully fetched 395 total users, 81 with target licenses
📊 Fetching ALL users with licenses from Microsoft Graph...
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
✅ Graph API token acquired successfully
📄 Fetched 395 users (Total: 395)
✅ Successfully fetched 395 total users, 81 with target licenses
📊 Fetching ALL users with licenses from Microsoft Graph...
✅ Graph API token acquired successfully
📄 Fetched 395 users (Total: 395)
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
✅ Successfully fetched 395 total users, 81 with target licenses
📊 Fetching ALL users with licenses from Microsoft Graph...
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
✅ Graph API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
🛡️ Fetching ALL devices from Microsoft Defender...
📄 Fetched 395 users (Total: 395)
✅ Defender API token acquired successfully
✅ Successfully fetched 395 total users, 81 with target licenses
📊 Fetching ALL users with licenses from Microsoft Graph...
✅ Graph API token acquired successfully
📄 Fetched 395 users (Total: 395)
✅ Successfully fetched 395 total users, 81 with target licenses
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
📊 Fetching ALL users with licenses from Microsoft Graph...
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
✅ Graph API token acquired successfully
📄 Fetched 395 users (Total: 395)
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
✅ Successfully fetched 395 total users, 81 with target licenses
📊 Fetching ALL users with licenses from Microsoft Graph...
✅ Graph API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
📄 Fetched 395 users (Total: 395)
✅ Successfully fetched 395 total users, 81 with target licenses
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
🛡️ Fetching ALL devices from Microsoft Defender...
✅ Defender API token acquired successfully
📄 Fetched 220 devices (Total: 220)
✅ Successfully fetched 220 total devices
